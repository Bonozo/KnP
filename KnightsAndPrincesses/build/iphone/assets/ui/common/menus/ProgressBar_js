function ProgressBar(e){function t(e){var t=1e3*e.Record[0].LEVEL+1e3,i=1e3*e.Record[0].LEVEL,n=e.Record[0].XP/t*100;l.width=""+n/100*45+"%",g.text=parseInt(e.Record[0].XP)+"/"+t;var o=e.Record[0].ENERGY/i*100;p.width=""+o/100*45+"%",a=parseInt(e.Record[0].ENERGY/i*100),m.text=a+"%",v.text="LVL "+e.Record[0].LEVEL,h.text=e.Record[0].STATUS_MESSAGE}function i(e){t(e),r.text=e.Record[0].NAME,d.text="m"==e.Record[0].GENDER?"KNIGHT":"PRINCESS"}var n=function(e,t,i,n,a,o){return{total_sec:60*e*60+60*t+i,timer:this.timer,instance_index:n,set:function(e,t,i){return this.total_sec=60*parseInt(e)*60+60*parseInt(t)+parseInt(i),this.time={h:e,m:t,s:i},this},start:function(){var e=this;return this.timer=setInterval(function(){if(e.total_sec){e.total_sec--;var t=parseInt(e.total_sec/3600),i=(e.total_sec-parseInt(3600*t)-e.total_sec%60)/60;e.time={h:parseInt(e.total_sec/3600),m:parseInt(i),s:e.total_sec%60},a(e.time.h+":"+e.time.m+":"+e.time.s,e.instance_index)}else e.stop(),o(e.instance_index)},1e3),this},stop:function(){return clearInterval(this.timer),this.time={h:0,m:0,s:0},this.total_sec=0,this}}},a=0,o=Titanium.UI.createView({top:"0%",height:"12.4%",width:"100%",backgroundImage:"/assets/overlayPlayerInfo.png"}),r=Titanium.UI.createLabel({text:e.Record[0].NAME,top:"0",height:"30.1%",left:"3%",textAlign:"left",color:"#5afd9b",font:{fontWeight:"bold",fontSize:"10dip"}});o.add(r);var s;s="m"==e.Record[0].GENDER?"KNIGHT":"PRINCESS";var d=Titanium.UI.createLabel({text:s,top:"0",height:"30.1%",right:"3%",textAlign:"right",color:"#5afd9b",font:{fontSize:"10dip"}});o.add(d);var c=Titanium.UI.createButton({top:"30.9%",left:"22.9%",height:"20%",width:"45.1%",backgroundImage:"/assets/Bar_Backdrop.png"});o.add(c);var l=Titanium.UI.createButton({top:"30.9%",left:"22.9%",height:"20%",width:"25.1%",backgroundImage:"/assets/XPBar.png"});o.add(l);var u=Titanium.UI.createButton({top:"60.3%",left:"22.9%",height:"20%",width:"45.1%",backgroundImage:"/assets/Bar_Backdrop.png"});o.add(u);var p=Titanium.UI.createButton({top:"60.3%",left:"22.9%",height:"20%",width:"35.1%",backgroundImage:"/assets/ENERGYBar.png"});o.add(p);var h=Titanium.UI.createLabel({text:e.Record[0].STATUS_MESSAGE,top:"80%",right:"7.9%",textAlign:Ti.UI.TEXT_ALIGNMENT_RIGHT,color:"#5afd9b",font:{fontSize:"10dip"}});o.add(h);var g=Titanium.UI.createLabel({text:"1000/1000",top:"30.9%",left:"68%",textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,color:"#5afd9b",font:{fontSize:"10dip"}});o.add(g);var m=Titanium.UI.createLabel({text:"1000/1000",top:"60.3%",left:"68%",textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,color:"#5afd9b",font:{fontSize:"10dip"}});o.add(m);var f=Titanium.UI.createLabel({text:"00:00:00",top:"60.3%",right:"6%",textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,color:"#5afd9b",font:{fontSize:"10dip"}});o.add(f);var T=function(){var t="http://bonozo.com:8080/knp/get_next_cron_time.php?uid="+e.Record[0].UID,i=require("/ui/common/Functions/function");i.requestServer({success:function(){var e=JSON.parse(this.responseText);if(void 0!=e.Record&&"NULL"!=e.Record.COUNTDOWN){var t=e.Record.COUNTDOWN.split(":"),i=new n(parseInt(t[0]),parseInt(t[1]),parseInt(t[2]),1,function(e){f.text=e},function(){I()});i.start()}},method:"GET",contentType:"text/xml",url:t})},I=function(){setTimeout(function(){100>a?T():I()},1e3)};!function(){I()}();var v=Titanium.UI.createLabel({text:"Level"+e.Record[0].LEVEL,top:"30.9%",left:"3%",textAlign:"right",color:"#5afd9b",font:{fontSize:"10dip"}});o.add(v);var _=Titanium.UI.createLabel({text:"Energy Level",top:"60.3%",left:"3%",textAlign:"right",color:"#5afd9b",font:{fontSize:"10dip"}});o.add(_),t(e),Ti.App.addEventListener("new_info",function(e){i(e.userinfojson)}),Ti.App.addEventListener("update_xp",function(){var i=require("/ui/common/Functions/function");i.requestServer({success:function(){var e=JSON.parse(this.responseText);t(e)},method:"GET",contentType:"text/xml",url:"http://bonozo.com:8080/knp/get_avatar_info.php?uid="+e.Record[0].UID})});var E=Ti.Platform.osname;if("iphone"===E||"ipad"===E){var R=function(){setTimeout(function(){if(Ti.App.Properties.getString("service_enabled")){var e=Ti.App.Properties.getString("uid");Ti.App.fireEvent("service_notification",{uid:e}),R()}Ti.API.info("service run!")},5e3)};R()}return o}module.exports=ProgressBar;