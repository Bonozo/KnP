function OptionsScreen(e){function t(e){return"android"===d?(u.retrieveDeviceToken({success:function(t){e(!0,t.deviceToken)},error:function(t){e(!1,t.message)}}),void 0):(e(!0,Titanium.Network.remoteDeviceUUID),void 0)}function i(e,t,i){h.Users.login({login:e,password:t},function(e){if(e.success){var t=e.users[0];i(!0,t.id)}else i(!1,e.message)})}function n(e,t,i,n,o){h.Users.create({email:e,username:e,password:n,password_confirmation:n},function(e){if(e.success){var t=e.users[0];o(!0,t.id)}else o(!1,e.message)})}function o(e,t){h.Users.query({page:1,per_page:10,where:{email:e}},function(e){e.success?e.users.length>0?t(!0,e.users[0].id):t(!0,""):t(!1,e.message)})}function a(e,t,n,o){c?h.PushNotifications.unsubscribe({channel:t,device_token:n,user_id:e},function(e){e.success?o(!0,"Successfully unsubscribed"):o(!1,e.message)}):i("admin@bonozo.com","admin",function(){c=!0,h.PushNotifications.unsubscribe({device_token:n,channel:t,user_id:e},function(e){e.success?o(!0,"Successfully unsubscribed"):o(!1,e.message)})})}function r(e,t,a,r){c?o(e,function(i,o){""==o?n(e,"","","test",function(e,i){e?h.PushNotifications.subscribe({channel:t,device_token:a,user_id:i,type:"android"},function(e){e.success?r(!0,i):r(!1,e.message)}):r(!1,i)}):h.PushNotifications.subscribe({channel:t,device_token:a,user_id:o,type:"android"},function(e){e.success?r(!0,o):r(!1,e.message)})}):i("admin@bonozo.com","admin",function(i,s){i?(c=!0,o(e,function(i,o){""==o?n(e,"","","test",function(e,i){e?h.PushNotifications.subscribe({channel:t,device_token:a,user_id:i,type:"android"},function(e){e.success?r(!0,i):r(!1,e.message)}):alert("created_uid="+i)}):h.PushNotifications.subscribe({channel:t,device_token:a,user_id:o,type:"android"},function(e){e.success?r(!0,o):r(!1,e.message)})})):r(!1,s)})}function s(t,i,n){var o="http://bonozo.com:8080/knp/set_notification.php?uid="+e.Record[0].UID+"&device_token="+t+"&user_id="+i,a=require("/ui/common/Functions/function");a.requestServer({success:function(){items_json=JSON.parse(this.responseText),void 0!=items_json.Message&&(p=items_json.Message.NOTIFICATION,g.title="NOTIFICATION "+items_json.Message.NOTIFICATION,n(!0,items_json.Message))},method:"GET",contentType:"text/xml",url:o})}var d=Ti.Platform.osname,c=!1,l=Titanium.UI.createView({top:"23%",height:"78%",width:"100%",backgroundImage:"/assets/inventoryBackground.png"});if("android"===d){var u=require("ti.cloudpush");u.debug=!0,u.enabled=!0,u.showTrayNotificationsWhenFocused=!0,u.focusAppOnPush=!1;var p="",h=require("ti.cloud");h.debug=!0}var g="",m="http://bonozo.com:8080/knp/get_notification_setting.php?uid="+e.Record[0].UID,f=require("/ui/common/Functions/function");f.requestServer({success:function(){items_json=JSON.parse(this.responseText),void 0!=items_json.Record&&(g.title="NOTIFICATION "+items_json.Record[0].NOTIFICATION,p=items_json.Record[0].NOTIFICATION)},method:"GET",contentType:"text/xml",url:m});var T=Titanium.UI.createLabel({text:"v0.5.6",bottom:"16%",left:"84.8%",textAlign:"center",color:"#5afd9b",font:{fontSize:"12dip"}});l.add(T);var I=(e.Record[0].GENDER,Ti.UI.createImageView({height:"0.1%",width:"0.%",bottom:"0%",left:"0%",image:"/assets/1.png"}));l.add(I);var v=Ti.UI.createView({width:"50%",height:"85%",right:"60%",top:"5%",zIndex:500});l.add(v);var _=1;l.addEventListener("load",function(){1==_&&_++});var E=Titanium.UI.createButton({color:"#761f56",top:"7%",height:"10%",title:"SOUND "+Ti.App.Properties.getString("knp_sound","OFF"),width:"60%",backgroundImage:"/assets/button_smallLong_UP.png"});E.addEventListener("click",function(){Ti.App.Properties.setString("knp_sound","ON"==Ti.App.Properties.getString("knp_sound","ON")?"OFF":"ON"),E.title="SOUND "+Ti.App.Properties.getString("knp_sound")}),l.add(E);var b=Titanium.UI.createButton({color:"#761f56",top:"19%",height:"9%",title:"MUSIC ON",width:"60%",backgroundImage:"/assets/button_smallLong_UP.png"});l.add(b),g=Titanium.UI.createButton({color:"#761f56",top:"31%",height:"9%",title:"NOTIFICATION ",width:"60%",backgroundImage:"/assets/button_smallLong_UP.png"}),l.add(g),g.addEventListener("click",function(){var i=Titanium.UI.createAlertDialog({title:"Click 'Yes' Change settings.",message:"Are you Sure?",buttonNames:["Yes","No"],cancel:1});i.show(),i.addEventListener("click",function(i){if(Titanium.API.info("e = "+JSON.stringify(i)),i.cancel!==i.index&&i.cancel!==!0)switch(i.index){case 0:"android"===d&&t(function(t,i){"ON"==p?o(e.Record[0].EMAIL,function(e,t){e&&a(t,"alert",i,function(){s(i,t,function(){alert("Notification settings changed.")})})}):"OFF"==p&&r(e.Record[0].EMAIL,"alert",i,function(e,t){s(i,t,function(){alert("Notification settings changed.")})})});break;case 1:}})});var R=Titanium.UI.createButton({color:"#761f56",top:"43%",height:"9%",title:"REPORT ABUSE",width:"60%",backgroundImage:"/assets/button_smallLong_UP.png"});l.add(R);var S=Titanium.UI.createButton({color:"#761f56",top:"55%",height:"9%",title:"RESET GAME",width:"60%",backgroundImage:"/assets/button_smallLong_UP.png"});l.add(S),S.addEventListener("click",function(){var t=Titanium.UI.createAlertDialog({title:"WARNING!",message:"All the data will be Lost.",buttonNames:["OK"]});t.show(),t.addEventListener("click",function(){i.show()});var i=Titanium.UI.createAlertDialog({title:"Click 'Yes' to Reset Game.",message:"Are you Sure?",buttonNames:["Yes","No"],cancel:1});i.addEventListener("click",function(t){if(Titanium.API.info("e = "+JSON.stringify(t)),t.cancel!==t.index&&t.cancel!==!0)switch(t.index){case 0:var i=require("/ui/common/MenuScreen/ResetClass"),n=new i(e);n.open();var o="http://bonozo.com:8080/knp/reset_option.php?uid="+e.Record[0].UID,a=require("/ui/common/Functions/function");a.requestServer({success:function(){Ti.App.fireEvent("update_footer",{clicked_item:"OptionScreen"}),items_json=JSON.parse(this.responseText),void 0!=items_json.Record&&""!=items_json.Record.Message&&alert(items_json.Record.Message)},method:"GET",contentType:"text/xml",url:o});break;case 1:}})});var A=Titanium.UI.createButton({color:"#761f56",top:"67%",height:"9%",title:"LOG OUT",width:"60%",backgroundImage:"/assets/button_smallLong_UP.png"});return l.add(A),A.addEventListener("click",function(){Ti.App.Properties.setBool("signed_in",!1),Ti.App.fireEvent("close_window")}),"android"===d&&(u.addEventListener("callback",function(){}),u.addEventListener("trayClickLaunchedApp",function(){}),u.addEventListener("trayClickFocusedApp",function(){})),l}module.exports=OptionsScreen;