function MainMenuScreen(e){function t(e,t){var i=require("ui/common/MenuScreen/"+t);return i(e)}function i(){if("iPhone OS"==Titanium.Platform.name){var e=Titanium.Platform.version.split("."),t=parseInt(e[0]);if(t>=4)return!0}return!1}function n(){if(c++,c>=3){if(""==e.Record[0].NAME){var t=require("/ui/common/MenuScreen/ResetClass"),i=new t(e);i.open()}Ti.App.fireEvent("signed_in")}}var o=Ti.Platform.osname,a="StatusScreen",r=[],s=e,d=Titanium.UI.createWindow({backgroundImage:"/assets/inventoryBackground.png",fullscreen:!0,navBarHidden:!0});d.orientationModes=[Ti.UI.PORTRAIT,Ti.UI.UPSIDE_PORTRAIT],Ti.App.addEventListener("close_window",function(){d.close()});var c=0;if(Ti.App.Properties.setString("uid",e.Record[0].UID),"iphone"===o||"ipad"===o){if(i()){Ti.App.Properties.setString("service_enabled",!0)}}else{var l=5,u=Titanium.Android.createServiceIntent({url:"services/notificationservice.js"});u.putExtra("interval",1e3*l),u.putExtra("uid",e.Record[0].UID),Titanium.Android.startService(u)}var p=Titanium.Platform.displayCaps.platformWidth,h=Titanium.Platform.displayCaps.platformHeight,g=Titanium.UI.createView({backgroundColor:"#FFFFFF",borderRadius:10,borderColor:"#333333",borderWidth:"5dip",visible:!1,top:h/2,left:p/4,height:"8%",width:p/2}),m=Ti.UI.createActivityIndicator({color:"#333333",font:{fontSize:"14dip",fontWeight:"bold"},message:"Loading...",style:"iPhone OS"===Ti.Platform.name?Ti.UI.iPhone.ActivityIndicatorStyle.DARK:Ti.UI.ActivityIndicatorStyle.DARK,height:"100%",width:"100%"});g.add(m),d.add(g);var f=require("/ui/common/Functions/function");f.requestServer({success:function(){var e=JSON.parse(this.responseText),t=require("ui/common/menus/ProgressBar");r.header=t(e),t=null;var i=require("ui/common/menus/Footer");r.footer=i(e),i=null,d.add(r.header),d.add(r.footer),n()},method:"GET",contentType:"text/xml",url:"http://bonozo.com:8080/knp/get_avatar_info.php?uid="+e.Record[0].UID}),m.show(),g.visible=!0,r.body=t(e,a),d.add(r.body),m.hide(),g.visible=!1;var T=require("ui/common/menus/MenuIcons");return r.menuIcons=T(a),T=null,d.add(r.menuIcons),n(),Ti.App.addEventListener("menu_active",function(e){m.show(),g.visible=!0,d.remove(r.body),r.body=t(s,e.clicked_item),d.add(r.body),m.hide(),g.visible=!1}),Ti.App.addEventListener("new_info",function(e){m.show(),g.visible=!0,d.remove(r.body),s=e.userinfojson,r.body=t(e.userinfojson,e.clicked_item),d.add(r.body),m.hide(),g.visible=!1}),Ti.App.addEventListener("game_played",function(){}),d.addEventListener("open",function(){n()}),d.addEventListener("android:back",function(){Titanium.Android.stopService(u);var e=Titanium.Android.currentActivity;e.finish()}),d}module.exports=MainMenuScreen;