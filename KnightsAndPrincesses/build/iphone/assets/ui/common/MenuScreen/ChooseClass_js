function ChooseClass(){function e(){f++}function t(e,t,i){h.Users.login({login:e,password:t},function(e){if(e.success){var t=e.users[0];i(!0,t.id)}else i(!1,e.message)})}function i(e){h.Users.logout(function(t){t.success?e(!0,"Successfully logout"):e(!1,t.message)})}function n(e,t,i,n,a){h.Users.create({email:e,username:e,password:n,password_confirmation:n},function(e){if(e.success){var t=e.users[0];a(!0,t.id)}else a(!1,e.message)})}function a(e,t){h.Users.query({page:1,per_page:10,where:{email:e}},function(e){e.success?e.users.length>0?t(!0,e.users[0].id):t(!0,""):t(!1,e.message)})}function r(e,i,r,o){l?a(e,function(t,a){""==a?n(e,"","","test",function(e,t){e?h.PushNotifications.subscribe({channel:i,device_token:r,user_id:t,type:"android"},function(e){e.success?o(!0,t):o(!1,e.message)}):o(!1,t)}):h.PushNotifications.subscribe({channel:i,device_token:r,user_id:a,type:"android"},function(e){e.success?o(!0,a):o(!1,e.message)})}):t("admin@bonozo.com","admin",function(t,d){t?(l=!0,a(e,function(t,a){""==a?n(e,"","","test",function(e,t){e?h.PushNotifications.subscribe({channel:i,device_token:r,user_id:t,type:"android"},function(e){e.success?o(!0,t):o(!1,e.message)}):alert("created_uid="+t)}):h.PushNotifications.subscribe({channel:i,device_token:r,user_id:a,type:"android"},function(e){e.success?o(!0,a):o(!1,e.message)})})):o(!1,d)})}function o(e,i,n,a){l?h.PushNotifications.unsubscribe({channel:i,device_token:n,user_id:e},function(e){e.success?a(!0,"Successfully unsubscribed"):a(!1,e.message)}):t("admin@bonozo.com","admin",function(){l=!0,h.PushNotifications.unsubscribe({channel:i,device_token:n,user_id:e},function(e){e.success?a(!0,"Successfully unsubscribed"):a(!1,e.message)})})}function d(e,t,i,n,a,r){var o=require("/ui/common/Functions/function");o.requestServer({success:function(){var e=JSON.parse(this.responseText);void 0!=e.Record?r(!0,e):void 0!=e.Error?alert(e.Error):alert("Something went wrong!")},method:"GET",contentType:"text/xml",url:"http://bonozo.com:8080/knp/sign_up.php?email="+t+"&password="+i+"&name="+e+"&gender="+n+"&device_token="+a})}function s(e,t,i,n){var a=require("/ui/common/Functions/function");a.requestServer({success:function(){var e=JSON.parse(this.responseText);void 0!=e.Record[0]?n(!0,e.Record[0]):void 0!=e.Error&&(void 0!=e.Error.AuthException?n(!1,e.Error.AuthException):e.Error.Request?n(!1,e.Error.Request):n(!1,"Unknown error occured!"))},method:"GET",contentType:"text/xml",url:"http://bonozo.com:8080/knp/insert_uid_token.php?email="+e+"&uid="+t+"&token="+i})}function c(e){e(Titanium.Platform.id)}var u=Ti.Platform.osname,l=!1,p="m",f=0;if("android"===u){var m=require("ti.cloudpush");m.debug=!0,m.enabled=!0,m.showTrayNotificationsWhenFocused=!0,m.focusAppOnPush=!1;var h=require("ti.cloud");h.debug=!0}var g=Ti.UI.createWindow({backgroundGradient:{type:"linear",colors:["#3258ad","#010f49"],startPoint:{x:"0%",y:"0%"},endPoint:{x:"0%",y:"100%"},backFillStart:!1},height:"100%",width:"100%",navBarHidden:!0,fullscreen:!0}),v=[],T=Titanium.UI.createImageView({top:"0%",image:"/assets/overlayTitleStarCurtains.png"});v.header=T,T.addEventListener("load",function(){e()}),g.add(T);var b=Titanium.UI.createImageView({image:"/assets/iconReturn.png",width:"11.6%",top:"0.3%",right:"3%",zIndex:500});g.add(b),b.addEventListener("click",function(){g.close(),Ti.App.fireEvent("close_screen",{screen_name:"choose_your_class"})});var _=Titanium.UI.createLabel({text:"Choose Your Class",textAlign:"center",color:"#4dd28f",font:{fontStyle:"Century Gothic",fontSize:"16dip"},top:"1",height:"4.9%"});v.header_label=_,g.add(_);var E=Titanium.UI.createImageView({top:"10%",image:"/assets/k_fullbody_bad.png",zIndex:5});E.addEventListener("load",function(){e()}),g.add(E);var I=Titanium.UI.createImageView({top:"30%",left:"60%",width:"25%",height:"20%",image:"/assets/iconControlArrowLeft.png",zIndex:10});g.add(I),I.addEventListener("load",function(){e()});var R=Titanium.UI.createImageView({bottom:"0%",right:"0%",image:"/assets/iconNextArrow.png",height:"10%",width:"35%",zIndex:10});g.add(R),R.addEventListener("load",function(){e()});var w=Titanium.UI.createImageView({left:"10%",top:"52%",width:"80%",height:"15%",image:"/assets/overlayNameScroll.png",zIndex:15}),x=Titanium.UI.createTextField({left:"15%",top:"46%",width:"70%",hintText:"Name",height:"15%",paddingLeft:"3",backgroundColor:"transparent",backgroundImage:"/assets/overlayNameScroll.png",paddingLeft:40,paddingRight:30,zIndex:20});("iphone"===u||"ipad"===u)&&(x.addEventListener("focus",function(){x.animate({top:"40%",duration:500}),w.animate({top:"45%",duration:500})}),x.addEventListener("blur",function(){x.animate({top:"46%",duration:500}),w.animate({top:"56%",duration:500})})),g.add(x);var S=Titanium.UI.createImageView({left:"10%",top:"63%",width:"80%",height:"15%",image:"/assets/overlayNameScroll.png",zIndex:25}),L=Titanium.UI.createTextField({left:"15%",top:"59%",width:"70%",hintText:"Email",height:"15%",backgroundImage:"/assets/overlayNameScroll.png",paddingLeft:40,paddingRight:30,backgroundColor:"transparent",zIndex:30});("iphone"===u||"ipad"===u)&&(L.addEventListener("focus",function(){L.animate({top:"40%",duration:500}),S.animate({top:"45%",duration:500})}),L.addEventListener("blur",function(){L.animate({top:"59%",duration:500}),S.animate({top:"65.5%",duration:500})})),g.add(L);var U=Titanium.UI.createImageView({left:"10%",top:"81%",width:"80%",height:"15%",image:"/assets/overlayNameScroll.png",zIndex:35}),A=Titanium.UI.createTextField({left:"15%",top:"73%",width:"70%",hintText:"Password",height:"15%",backgroundImage:"/assets/overlayNameScroll.png",paddingLeft:40,paddingRight:30,passwordMask:!0,backgroundColor:"transparent",zIndex:40});("iphone"===u||"ipad"===u)&&(A.addEventListener("focus",function(){A.animate({top:"40%",duration:500}),U.animate({top:"45%",duration:500})}),A.addEventListener("blur",function(){A.animate({top:"73%",duration:500}),U.animate({top:"75%",duration:500})})),g.add(A);var y=(Titanium.UI.createImageView({top:"10%",right:0,image:"/assets/hdpi_female_character.png",zIndex:5}),Titanium.UI.createImageView({top:"30%",left:"10%",visible:!1,width:"25%",height:"20%",image:"/assets/iconControlArrowRight.png",zIndex:10}));y.addEventListener("load",function(){e()}),I.addEventListener("click",function(){E.image="/assets/hdpi_female_character.png",p="f",I.hide(),y.show()}),g.add(y),y.hide(),g.add(I),y.addEventListener("click",function(){E.image="/assets/k_fullbody_bad.png",p="m",y.hide(),I.show()});var N=(require("/ui/common/MenuScreen/Customization"),null),k=Titanium.UI.createAlertDialog({title:"Login Failed",message:"User not found.",buttonNames:["OK"]});return k.addEventListener("click",function(){k.close()}),R.addEventListener("click",function(){""==L.value||""==A.value||""==x.value?alert("All fields are required!"):(L.value=L.value.toLowerCase(),c(function(e,t){e&&d(x.value,L.value,A.value,p,t,function(e,n){if("iphone"===u||"ipad"===u){var d=require("/ui/common/MenuScreen/MainMenuScreen"),c=new d(n);return c.open(),void 0}e&&("NULL"==n[0].LAST_USER?r(L.value,"alert",t,function(e,a){e?s(L.value,a,t,function(e,t){e?i(function(){n={Record:n};var e=require("/ui/common/MenuScreen/Customization");customization=new e(n),customization.open()}):alert(t)}):alert(a)}):a(n[0].LAST_USER,function(e,i){var a=n[0].LAST_USER;o(i,"alert",t,function(e){e&&r(L.value,"alert",t,function(e,i){s(L.value,i,t,function(e,t){e?(n={Record:n},s(a,"","",function(e,t){if(e){var i=require("/ui/common/MenuScreen/Customization");customization=new i(n),customization.open()}else alert(t)})):alert(t)})})})}))})}))}),"android"===u&&g.addEventListener("android:back",function(){Ti.App.fireEvent("close_screen",{screen_name:"choose_your_class"})}),Ti.App.addEventListener("customization",function(){null!=N?(N.close(),N=null):Ti.App.fireEvent("close_screen",{screen_name:"choose_your_class"})}),"android"===u&&(m.addEventListener("callback",function(){}),m.addEventListener("trayClickLaunchedApp",function(){}),m.addEventListener("trayClickFocusedApp",function(){})),g}module.exports=ChooseClass;