function FreindQuestTab(e,t){var i=require("/ui/common/drawings/AvatarThumbnail"),n=function(e,t,i,n,o,a){return{total_sec:60*e*60+60*t+i,timer:this.timer,instance_index:n,set:function(e,t,i){return this.total_sec=60*parseInt(e)*60+60*parseInt(t)+parseInt(i),this.time={h:e,m:t,s:i},this},start:function(){var e=this;return this.timer=setInterval(function(){if(e.total_sec){e.total_sec--;var t=parseInt(e.total_sec/3600),i=(e.total_sec-parseInt(3600*t)-e.total_sec%60)/60;e.time={h:parseInt(e.total_sec/3600),m:parseInt(i),s:e.total_sec%60},o(e.time.h+":"+e.time.m+":"+e.time.s,e.instance_index)}else e.stop(),a(e.instance_index)},1e3),this},stop:function(){return clearInterval(this.timer),this.time={h:0,m:0,s:0},this.total_sec=0,this}}};Ti.App.addEventListener("remove_friend_quest",function(e){o.deleteRow(e.index)});var o,a=Titanium.Platform.displayCaps.platformWidth,r=[],d="",s=[],c=.2*a,l=0,u="",p=0,f=Ti.UI.createLabel({text:"You have not assigned any Quest!",font:{fontWeight:"bold",fontSize:"18dip"},color:"#b3fad0"}),m=[],g=[],h=[],T=require("/ui/common/Functions/function");T.requestServer({success:function(){if(u=JSON.parse(this.responseText),p=u.Record.length,void 0!=u.Record){for(var e=[],a=0;a<u.Record.length;a++){s[l]=Ti.UI.createTableViewRow({className:"friend_quests",height:c,backgroundImage:"/assets/quest_row_bg.png"}),s[l].addEventListener("longpress",function(e){Titanium.Media.vibrate();var t=require("/ui/common/MenuScreen/RemoveQuest"),i=new t(u.Record[e.index].ASSIGN_QUEST_ID,e.index,"ASSIGNER");i.open({modal:!0})}),i({width:"13%",top:"2px",left:"5px"},u.Record[a].USER_APPEARANCE,u.Record[a].GENDER,l,function(e,t){h[t]=e,s[t].add(h[t])});var T=Ti.UI.createLabel({text:u.Record[a].NAME,top:"10%",font:{fontSize:"18dip",fontWeight:"bold"},color:"#5afd9b",left:"18%",width:"45%"});s[l].add(T);var I=Ti.UI.createLabel({text:"LVL "+u.Record[a].LEVEL,top:"38%",font:{fontSize:"12dip"},color:"#5afd9b",left:"18%",width:"45%"});s[l].add(I);{Ti.UI.createLabel({text:u.Record[a].NUM_OF_FRIENDS,color:"#5afd9b",font:{fontSize:"14dip"},left:"38%",textAlign:"center"})}if("COMPLETE"==u.Record[a].STATUS||"EXPIRE"==u.Record[a].STATUS){var v=Ti.UI.createLabel({text:"COMPLETE"==u.Record[a].STATUS?"Completed":"Time Expired",top:"35%",color:"#5afd9b",font:{fontSize:"12dip"},right:c/3,textAlign:"right"});s[l].add(v);var E=Ti.UI.createImageView({image:"COMPLETE"==u.Record[a].STATUS?"/assets/check_icon.png":"/assets/cross_icon.png",top:"30%",right:"5px",height:c/3.5,width:c/3.5});s[l].add(E)}else if(m[u.Record[a].ASSIGN_QUEST_ID]=Ti.UI.createImageView({image:"/assets/alarm_clock_icon.png",top:"40%",right:"5px",height:c/3.5,width:c/3.5}),s[l].add(m[u.Record[a].ASSIGN_QUEST_ID]),g[u.Record[a].ASSIGN_QUEST_ID]=Ti.UI.createLabel({text:u.Record[a].EXPIRED_TIME,complete:!0,top:"45%",color:"#5afd9b",font:{fontSize:"12dip"},right:c/3,textAlign:"right"}),s[l].add(g[u.Record[a].ASSIGN_QUEST_ID]),"COMPLETE"!=u.Record[a].STATUS&&"EXPIRE"!=u.Record[a].STATUS){d+=u.Record[a].ASSIGN_QUEST_ID+":";var R=u.Record[a].EXPIRED_TIME.split(":");r[u.Record[a].ASSIGN_QUEST_ID]=new n(parseInt(R[0]),parseInt(R[1]),parseInt(R[2]),u.Record[a].ASSIGN_QUEST_ID,function(e,t){g[t].text=e},function(e){m[e].image="/assets/cross_icon.png",g[e].text="Time Expired",m[e].animate(Ti.UI.createAnimation({top:c/3.5,duration:500})),g[e].animate(Ti.UI.createAnimation({top:c/3,duration:500}))}),r[u.Record[a].ASSIGN_QUEST_ID].start()}var _=(Ti.UI.createLabel({text:"REWARDS:",color:"#5afd9b",font:{fontSize:"12dip"},bottom:10*c/100,right:"35%",textAlign:"center"}),Ti.UI.createLabel({text:u.Record[a].NUM_OF_QUESTS+" Quest(s)",color:"#5afd9b",font:{fontSize:"12dip",fontWeight:"bold"},bottom:"8%",left:"18%",textAlign:"center"}));s[l].add(_),e.push(s[l])}o=Ti.UI.createTableView({backgroundColor:"transparent",separatorColor:"transparent",data:e,width:"100%",height:"100%",top:"0%"});var b=Ti.UI.createView({backgroundColor:"transparent",width:"100%",height:"100%",top:"2%"});b.add(o),b.add(f),f.hide(),0==u.Record.length&&f.show(),t(b)}},method:"GET",contentType:"text/xml",url:"http://bonozo.com:8080/knp/knp_get_friend_quests.php?uid="+e.Record[0].UID})}module.exports=FreindQuestTab;