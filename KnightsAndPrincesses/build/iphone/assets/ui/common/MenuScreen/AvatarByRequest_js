function AvatarByRequest(e,t,r,i){function a(e,t){return Math.floor(Math.random()*(t-e+1))+e}function o(){Ti.App.fireEvent("request_send",{count:"0"})}var n=a(1,9e4),d=0,c=Titanium.Platform.displayCaps.platformWidth,s="",l=0,u="",p=[],f=require("/ui/common/drawings/AvatarThumbnail"),m=require("/ui/common/Functions/function");m.requestServer({success:function(){if(s=JSON.parse(this.responseText),l=s.Record.length,void 0!=s.Record){for(var a=.189*c,o="",m=0;m<s.Record.length;m++){d++,o="f"==s.Record[m].GENDER?"/assets/freind_request_female.png":"/assets/freind_request_male.png",r[m]=Ti.UI.createTableViewRow({className:"friendship_request_list",height:a,uid:s.Record[m].UID,index:m,backgroundImage:o,zIndex:10,user_info:s.Record[m]}),r[m].addEventListener("longpress",function(t){Titanium.Media.vibrate();var r=require("/ui/common/MenuScreen/FriendRequestAction"),i=new r(e,s.Record[t.row.index]);i.open()}),r[m].addEventListener("click",function(t){var r=require("/ui/common/MenuScreen/FriendRequestAction"),i=new r(e,s.Record[t.row.index]);i.open()}),f({width:"12%",height:"85.5%",top:"4.8px",right:"3%"},s.Record[m].USER_APPEARANCE,s.Record[m].GENDER,m,function(e,t){null!=n&&(p[t]=e,r[t].add(p[t]))});var h=Ti.UI.createLabel({text:"LVL "+s.Record[m].LEVEL,font:{fontSize:"12dip"},color:"#b3fad0",right:"20%",top:"5%"});r[m].add(h);var g=Titanium.UI.createImageView({image:"/assets/miGoldWide_up.png",visible:!0,right:"30%",width:"6%",height:"16%"});r[m].add(g);var v=Ti.UI.createLabel({text:s.Record[m].NUM_OF_GOLDS,font:{fontSize:"12dip"},color:"#b3fad0",right:"20%"});r[m].add(v);var T=Ti.UI.createLabel({text:"ONLINE",font:{fontSize:"12dip"},color:"#b3fad0",bottom:"5%",right:"20%"});r[m].add(T);var R=Ti.UI.createLabel({text:s.Record[m].NAME,font:{fontWeight:"bold",fontSize:"18dip"},color:"#b3fad0",left:"8px",top:"20%",width:"45%"});r[m].add(R);var b=(Ti.UI.createLabel({text:s.Record[m].STATUS_MESSAGE,font:{fontSize:"12dip"},top:"55%",color:"#b3fad0",left:"8px",width:"45%"}),Ti.UI.createLabel({text:"NEW FREIND REQUEST!",font:{fontSize:"10dip"},color:"#ffffff",left:"8%",bottom:"10%",width:"45%"}),Ti.UI.createLabel({text:s.Record[m].DATETIME,font:{fontWeight:"bold",fontSize:"12dip"},color:"#000000",left:"8%",bottom:"10%",width:"45%"}));r[m].add(b),t.push(r[m])}if(u=Ti.UI.createTableView({backgroundColor:"transparent",separatorColor:"transparent",data:t,width:"100%",height:"66%",top:"2%"}),s.Record.length>0)i(u);else{var _=Ti.UI.createLabel({text:"You have no friendship request!",font:{fontWeight:"bold",fontSize:"18dip"},color:"#b3fad0"});i(_),f=null}}},method:"GET",contentType:"text/xml",url:"http://bonozo.com:8080/knp/friendship_notifications.php?uid="+e.Record[0].UID}),Ti.App.addEventListener("request_check",function(){d--,0>=d&&o()}),Ti.App.addEventListener("avatar_table_changed",function(e){"AvatarByRequest"==e.release_table&&(n=null)})}module.exports=AvatarByRequest;