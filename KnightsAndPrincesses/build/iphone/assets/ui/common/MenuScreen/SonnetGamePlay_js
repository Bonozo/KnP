function SonnetGame(e,t,i,n,o){function a(){d++}function r(e,t){for(var i=0;i<t.length;i++)if(t[i].match(e))return i;return-1}var s=!1,n="",d=0,c=(Titanium.Platform.displayCaps.platformWidth,Ti.UI.createWindow({orientation:Ti.UI.PORTRAIT,navBarHidden:!0,fullscreen:!0}));c.orientationModes=[Ti.UI.PORTRAIT,Ti.UI.UPSIDE_PORTRAIT];var l=Titanium.UI.createView({width:"100%",height:"100%"});c.add(l);var u=require("ui/common/Functions/function");if(o){var p="http://bonozo.com:8080/knp/knp_assign_quests.php?assign_by_uid="+i.Record[0].UID+"&assign_to_uid="+i.Record[0].UID+"&quest_ids="+t+"&message=Single Player Game&num_of_hours=3&status=SINGLE_PLAYER_GAME",h="",g=0;u.requestServer({success:function(){if(h=JSON.parse(this.responseText),g=h.Record.length,void 0!=h.Record){if(h.Record[0].LOW_ENERGY){var e=Titanium.UI.createAlertDialog({title:"Low Energy!",message:h.Record[0].LOW_ENERGY,buttonNames:["OK"]});e.show(),e.addEventListener("click",function(){c.close()})}else n=h.Record[0].ASSIGN_QUEST_ID;a()}},method:"GET",contentType:"text/xml",url:p})}var m=Ti.UI.createImageView({image:"/assets/inventoryBackground.png",width:"100%",height:"100%"});l.add(m),a(),m.addEventListener("load",function(){a()});var f=Titanium.UI.createImageView({image:"/assets/overlayPlayerInfoCroped.png",height:"6.4%",width:"100%",bottom:"94.6%"});l.add(f);var T=Titanium.UI.createLabel({text:"SONNET GAME",top:"0",height:"3.1%",left:"3%",textAlign:"left",color:"#5afd9b",font:{fontWeight:"bold",fontSize:"12dip"}});l.add(T);var I=Titanium.UI.createLabel({text:"CREATE SONNET",top:"0",height:"3.1%",right:"8%",textAlign:"left",color:"#5afd9b",font:{fontWeight:"bold",fontSize:"12dip"}});l.add(I);var v=Titanium.UI.createImageView({image:"/assets/iconReturn.png",height:"8%",width:"11.6%",top:"1%",right:"3%"});l.add(v),v.addEventListener("click",function(){c.close()});var E=Titanium.UI.createLabel({text:"CHALLENGER: "+i.Record[0].NAME,top:"9%",left:"35%",textAlign:"left",color:"#5afd9b",font:{fontSize:"9dip"}});l.add(E);var _=Titanium.UI.createLabel({text:"TIME TO COMPLETE: 01:24:00",top:"27%",color:"#5afd9b",font:{fontSize:"9dip"}});l.add(_);var R=Titanium.UI.createImageView({backgroundImage:"/assets/games/sonnet/title_bg.png",height:"10%",width:"100%",top:"15%"});l.add(R);var b=Ti.UI.createView({backgroundColor:"#72AE94",borderColor:"#376b54",borderWidth:1,borderRadius:5,height:"12%",top:"14%",left:"3%",width:"72%"}),A=Titanium.UI.createLabel({text:"WRITE A SONNET ABOUT:",top:"1%",left:"2%",textAlign:"left",color:"#5afd9b",font:{fontSize:"10dip"}});b.add(A);var S=Titanium.UI.createLabel({text:"THE BLACK PLAGUE",color:"#0B0909",font:{fontWeight:"bold",fontSize:"13dip"}});b.add(S),l.add(b);var U=Ti.UI.createImageView({image:"m"==i.Record[0].GENDER?"/assets/male_icon.png":"/assets/female_icon.png",width:"28%",right:"1%",height:"15%",top:"11%"});l.add(U);var w=Titanium.UI.createView({backgroundImage:"/assets/games/sonnet/desc_bg.png",height:"16%",width:"100%",top:"30%"}),x=Titanium.UI.createImageView({backgroundImage:"/assets/iconSonnet.png",height:"25%",width:"10%",top:"1%",left:"1%"});w.add(x);var S=Titanium.UI.createLabel({text:"",top:"1%",left:"10%",color:"#5afd9b",font:{fontSize:"13dip"}});w.add(S),l.add(w);var L=Titanium.UI.createImageView({image:"/assets/overlayNameScroll.png",height:"25%",width:"100%",top:"41%"});l.add(L);var y=Titanium.UI.createButton({backgroundImage:"/assets/button_smallLong_UP.png",title:"UNDO WORD",left:"5%",top:"60%",font:{fontSize:"11"},height:"6%"});l.add(y);var N=Titanium.UI.createButton({title:"SUBMIT WORD",backgroundImage:"/assets/button_smallLong_UP.png",right:"5%",top:"60%",font:{fontSize:"11"},height:"6%"});l.add(N);var P=Ti.UI.createLabel({text:"RULE: WORD MUST BE ATLEAT 5 LETTERS",color:"#5AFD9B",font:{fontSize:"10"},top:"65%"});l.add(P);var k=Ti.UI.createView({top:"68%",height:"7%",width:"50%"});l.add(k);var C=Ti.UI.createImageView({image:"/assets/iconControlArrowLeft.png",right:"8%",width:"20%",height:"100%"});k.add(C),C.addEventListener("click",function(){});var M=Ti.UI.createImageView({image:"/assets/iconControlArrowRight.png",left:"10%",width:"20%",height:"100%"});k.add(M),M.addEventListener("click",function(){});var D=Ti.UI.createLabel({text:"SWAP RULE",color:"#5AFD9B",font:{fontSize:"12dip"},left:"25%",textAlign:"center"});k.add(D);var z=(Ti.UI.createLabel({text:"HOURS",color:"#5AFD9B",font:{fontSize:"12dip"},left:"40%",textAlign:"center"}),Ti.UI.createLabel({text:"LETTERS FOR THIS WORD:",color:"#5AFD9B",font:{fontSize:"10dip"},textAlign:"center",top:"72%"}),Ti.UI.createView({top:"65%",height:"30%",width:"98%",left:"4%"}));l.add(z);var G=Titanium.UI.createTextField({left:"25%",top:"45%",width:"70%",hintText:"Write a Sonnet",height:"15%",paddingLeft:"3",color:"#0B0909",backgroundColor:"transparent"});l.add(G);var O=["PLAGUE","KNIGHT","PRINCESS","GAMES","SONNET"],F=0,q=[];N.addEventListener("click",function(){var o=G.value;if(o.length<"5")alert("Word is too small.");else{var a=r(o,O);if("-1"==a){if(alert("You have entered a wrong word!"),G.value="",F++,"3"==F)if(s)alert("You have already played this quest!\nPress back button");else{p="http://bonozo.com:8080/knp/knp_set_quest_status.php?game_status=LOSS&quest_status="+e+"&assign_quest_id="+n+"&quest_id="+t+"&uid="+i.Record[0].UID+"&friend_uid="+i.Record[0].UID;var d=require("/ui/common/Functions/function"),l="";d.requestServer({success:function(){if(l=JSON.parse(this.responseText),void 0!=l.Record)if("Updated!"==l.Record[0].Message){var e=Titanium.UI.createAlertDialog({title:"Sorry!",message:"You lost the game!",buttonNames:["OK"]});e.show(),e.addEventListener("click",function(){c.close()})}else alert("message undefined");else alert("record undefined");Ti.App.fireEvent("update_xp",{clicked_item:"StatusScreen"})},method:"GET",contentType:"text/xml",url:p}),s=!0}}else{var u=r(o,q);if("0"==u&&(alert("You have already enter this word!"),G.value=""),"-1"==u&&(q.push(o),G.value="",S.text+=" "+o,q.length>="3"))if(s)alert("You have already played this quest!\nPress back button");else{var h=require("/ui/common/Functions/function"),l="";h.requestServer({success:function(){if(l=JSON.parse(this.responseText),void 0!=l.Record)if("Updated!"==l.Record[0].Message){Ti.App.fireEvent("game_played",{status:"complete"});var e=0,t="",i="";for(var n in l.Record[0]){if(l.Record[0].hasOwnProperty(n)){{n+" -> "+l.Record[0][n]}1==e?t=l.Record[0][n]:e>1&&(i+="\n"+n+"("+l.Record[0][n]+")")}e++}var o=Titanium.UI.createAlertDialog({title:"You have completed "+t+".",message:"Rewards earned:"+i,buttonNames:["OK"],zIndex:500});o.show(),o.addEventListener("click",function(){c.close()})}else alert("message undefined");else alert("record undefined");Ti.App.fireEvent("update_xp",{clicked_item:"StatusScreen"})},method:"GET",contentType:"text/xml",url:"http://bonozo.com:8080/knp/knp_set_quest_status.php?game_status=COMPLETE&quest_status="+e+"&assign_quest_id="+n+"&quest_id="+t+"&uid="+i.Record[0].UID+"&friend_uid="+i.Record[0].UID}),s=!0}}}});for(var V,W=0,j=2,B=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Q=0;Q<B.length;Q++)Q%8==0&&(W+=26,j=2),V=Titanium.UI.createButton({title:B[Q],backgroundImage:"/assets/button_smallLong_UP.png",left:j+"%",top:W+"%",value:B[Q],font:{fontSize:"16"},width:"10%",height:"25%"}),z.add(V),V.addEventListener("click",function(e){G.value+=e.source.value}),j+=11;return c.open({fullscreen:!0,navBarHidden:!0}),c}module.exports=SonnetGame;