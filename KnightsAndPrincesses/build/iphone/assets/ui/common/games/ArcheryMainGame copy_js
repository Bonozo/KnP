function ArcheryMainGame(e,t,i){function n(e,t){return"x"==e?E*t/100:"y"==e?_*t/100:void 0}function a(e,t){return e*t}function o(e,t){return e/t}function r(e,t,i){return e>=i.x&&e<=i.x+i.width&&t>=i.y&&t<=i.y+i.height?!0:!1}function s(e,t,i,n,a,o){var r=Math.pow(e-i,2)+Math.pow(t-n,2),s=Math.pow(a,2);return Ti.API.info(e+", "+t+", "+i+", "+n+", "+a),Ti.API.info(r+", "+s),r==s||r>=s&&s+o>=r||s>r&&r>=s-o?!0:!1}var d=Ti.UI.createWindow({orientation:Ti.UI.PORTRAIT,navBarHidden:!0,fullscreen:!0}),c=!1;d.orientationModes=[Ti.UI.PORTRAIT,Ti.UI.UPSIDE_PORTRAIT];var l=0,u=require("com.googlecode.quicktigame2d"),p=0,h=Titanium.Media.createSound({url:"/sounds/ambient_bird_chirps.mp3"}),g=Titanium.Media.createSound({url:"/sounds/arrow_draw.mp3"}),m=Titanium.Media.createSound({url:"/sounds/arrow_fly.mp3"}),f=Titanium.Media.createSound({url:"/sounds/arrow_hit.mp3"}),I=Titanium.Media.createSound({url:"/sounds/arrow_miss.mp3"}),T=u.createGameView();T.fps=30,T.color(0,0,0),T.debug=!0;var v=(new Array,u.createScene()),E=Ti.Platform.displayCaps.platformWidth,_=Ti.Platform.displayCaps.platformHeight;T.pushScene(v);var R=1,A=u.createSprite({image:"assets/games/archery/background.png",width:E,height:_});v.add(A);var b=n("x",30),w=u.createSprite({image:"assets/games/archery/bullseye.png",width:b,height:b,x:n("x",50)-b/2,y:n("y",50)-b/2,z:4});v.add(w);var S=1.78515625,U=n("x",55),x=a(U,S),y=0,L=40,N=20,P=-40,k=0,M=-20,C=u.createSprite({image:"assets/games/archery/bow.png",width:U,height:x,x:M,y:_-(3*x/4+N),z:5});v.add(C);var G=3.5555,z=n("x",20),D=a(z,G),O=u.createSprite({image:"assets/games/archery/arrow.png",width:z,height:D,x:n("x",53)-z/2+M,y:_-(3*D/4+N),z:6});v.add(O);var p=0;T.addEventListener("onload",function(){R=T.screen.width/T.size.width,T.registerForMultiTouch(),T.start()}),T.addEventListener("click",function(){c&&alert("You have already played this quest!\nPress back button")});var F=50.14285,q=n("y",32),V=o(q,F),j=u.createSprite({image:"assets/games/archery/indicator_y_bg.png",width:V,height:q,x:E-n("x",6),y:n("y",15),z:500});v.add(j);var W=1.084745,B=n("x",10),Q=a(B,W),H=Ti.UI.createLabel({text:"("+(E-n("y",4.5))+", "+n("x",.5)+"): "+B+"x"+Q,color:"#000000",font:{fontSize:"14dip"},visible:!1,top:0,zIndex:700});d.add(H);var Y=u.createSprite({image:"assets/games/archery/indicator_pointer.png",width:B,height:Q,x:E-n("x",10),y:j.y+j.height/2-Q/2,z:510}),J=j.y-Y.height/2,K=j.y+j.height-Y.height/2,X=K-J,Z=X/L,$=0;v.add(Y);var et=!1;H.text="("+n("y",4.5)+", "+n("x",10)+"): "+B+"x"+Q;var tt=.019943,it=n("x",50),nt=a(it,tt),at=u.createSprite({image:"assets/games/archery/indicator_x_bg.png",width:it,height:nt,x:n("x",6),y:_-n("y",6),z:500});v.add(at);var ot=u.createSprite({image:"assets/games/archery/indicator_pointer.png",width:B,height:Q,x:n("x",6)/2+it,y:_-n("y",6)-Q/2,z:510}),rt=at.x-ot.width/2,st=at.x+at.width-ot.width/2,X=st-rt,Z=X/L,$=0;v.add(ot);var dt=!1,ct=!1,lt=O.y,ut=O.y,pt=O.y+60,ht={},gt=!1;T.addEventListener("touchstart",function(e){r(e.x,e.y,Y)?et=!0:r(e.x,e.y,ot)?dt=!0:gt||(gt=!0,ct=!0,ht.x=e.x,ht.y=e.y),Ti.API.info(e.y)});var mt={},ft=0,It=0;T.addEventListener("touchmove",function(e){et&&e.y>=J&&e.y<=K?((e.y%Z>=-$||e.y%Z<$)&&(mt.y<e.y?(H.text=N+" > "+y+" > "+L,N>y+1&&(ft--,N--)):L-1>N&&(N++,ft++)),C.y=_-(3*x/4+N),O.y=_-(3*D/4+N),Y.y=e.y,lt=O.y,ut=O.y,pt=O.y+60):dt&&e.x>=rt&&e.x<=st?((e.x%Z>=-$||e.x%Z<$)&&(mt.x<e.x?k+1>M&&(It++,M++):M>P-1&&(It--,M--),C.x=M,O.x=n("x",53)-z/2+M),H.text=M+" > "+P+" > "+k,ot.x=e.x):ct&&mt.y<e.y?(pt-1>lt&&(g.play(),It++,lt++),O.y=lt,H.text=lt+" :: "+ut+" :: "+pt):ct&&mt.y>e.y&&(lt>ut+1&&(g.play(),lt--,It--),O.y=lt,H.text=lt+" :: "+ut+" :: "+pt),H.text=w.collidesWith(O),mt.x=e.x,mt.y=e.y}),T.addEventListener("touchend",function(e){if(et)et=!1;else if(dt)dt=!1;else if(ct){ct=!1;var t=u.createTransform();t.duration=200,t.scale_centerX=O.width/2,t.scale_centerY=0,t.scale(.3,.3),t.easing=u.ANIMATION_CURVE_EASE_IN,t.y=n("y",30)+(_-O.y)-4*ft-4*It,t.x=ht.x>e.x?O.x+2*(ht.x-e.x):O.x-2*(e.x-ht.x),t.z=4,O.transform(t),H.text=7*(_-lt)/5+n("x",40),m.play(),setTimeout(function(){m.stop(),g.stop(),H.text=O.x+O.width/2+", "+O.y;for(var e=b/2/4,t=!1,i=w.x+w.width/2,n=w.y+w.height/2,a=0,o=30,r=a;e>r;r+=1)if(a=r,s(O.x+O.width/2,O.y,i,n,r,o)){t=!0;break}if(t)l=100;else{for(var d=b/2/2,o=70,r=a;d>r;r+=1)if(a=r,s(O.x+O.width/2,O.y,i,n,r,o)){t=!0;break}if(t)l=80;else{for(var o=80,c=b/2*3/4,r=a;c>r;r+=1)if(a=r,s(O.x+O.width/2,O.y,i,n,r,o)){t=!0;break}if(t)l=50;else{for(var o=100,u=b/2,r=a;u>r;r+=1)if(a=r,s(O.x+O.width/2,O.y,i,n,r,o)){t=!0;break}t&&(l=25)}}}t?f.play():I.play(),alert(0!=l?"You have earned "+l+" points!":"You earned no point.")},300);var i=Ti.UI.createButton({color:"#761f56",title:"Reset",top:n("y",10),zIndex:900});i.addEventListener("click",function(){ft=0,It=0,l=0,H.text=w.collidesWith(O),y=0,L=40,N=20,P=-40,k=0,M=-20,lt=ut,C.y=_-(3*x/4+N),C.x=M,O.z=6,O.scale(1),O.x=n("x",53)-z/2+M,O.y=_-(3*D/4+N),lt=O.y,ut=O.y,pt=O.y+60,i.visible=!1,gt=!1}),d.add(i)}});var Tt=0;return d.addEventListener("open",function(){var e=d.activity;e.addEventListener("resume",function(){p=setInterval(function(){Tt%41e3==0&&h.play()},1e3)}),e.addEventListener("pause",function(){clearInterval(p),h.stop(),p=null}),e.addEventListener("destroy",function(){clearInterval(p),h.stop(),p=null})}),d.add(T),d.open({fullscreen:!0,navBarHidden:!0}),d}module.exports=ArcheryMainGame;