function AvatarCustomization(e){function t(e,t){for(var i=0;i<e.length;i++)if(e[i].WEAR_ID==t)return i;return-1}function i(){a&&(s.hair=n(0,r.hair.length-1),d.title=r.hair[s.hair].NAME,Ti.App.fireEvent("update_appearance",{item:"hair",gender:e.gender,image:r.hair[s.hair].IMAGE}),a&&(s.face=n(0,r.face.length-1),c.title=r.face[s.face].NAME,Ti.App.fireEvent("update_appearance",{item:"face",gender:e.gender,image:r.face[s.face].IMAGE}),a&&(s.dress=n(0,r.dress.length-1),l.title=r.dress[s.dress].NAME,Ti.App.fireEvent("update_appearance",{item:"dress",gender:e.gender,image:r.dress[s.dress].IMAGE}),a&&("f"==e.gender?(s.jewelery=n(0,r.jwelery.length-1),u.title=r.jwelery[s.jewelery].NAME):(s.weapon=n(0,r.weapons.length-1),u.title=r.weapons[s.weapon].NAME),Ti.App.fireEvent("update_appearance",{item:"m"==e.gender?"weapon":"jewelery",gender:e.gender,image:"m"==e.gender?r.weapons[s.weapon].IMAGE:r.jwelery[s.jewelery].IMAGE})))))}function n(e,t){return Math.floor(Math.random()*(t-e+1))+e}var a=!1,o=Titanium.UI.createView(e.main_view),r={},s={},d=Titanium.UI.createButton({backgroundImage:"/assets/button_small_UP.png",title:e.btn_labels.hair,height:"10%",width:"100%",top:0,left:0,font:{fontSize:14},color:"#761f56"}),c=Titanium.UI.createButton({backgroundImage:"/assets/button_small_UP.png",title:e.btn_labels.head,height:"10%",width:"100%",top:"10.5%",left:0,font:{fontSize:14},color:"#761f56"}),l=Titanium.UI.createButton({backgroundImage:"/assets/button_small_UP.png",title:e.btn_labels.dress,height:"10%",width:"100%",top:"21%",left:0,font:{fontSize:14},color:"#761f56"}),u=Titanium.UI.createButton({backgroundImage:"/assets/button_small_UP.png",title:"m"==e.gender?e.btn_labels.weapon:e.btn_labels.jewelery,height:"10%",width:"100%",top:"31.5%",left:0,font:{fontSize:14},color:"#761f56"});if("m"==e.gender){var p=Titanium.UI.createButton({backgroundImage:"/assets/button_small_UP.png",title:e.btn_labels.shield,height:"10%",width:"100%",top:"42%",left:0,font:{fontSize:14},color:"#761f56"});p.addEventListener("click",function(){a&&(s.shield>=r.shield.length-1?s.shield=0:s.shield++,p.title=r.shield[s.shield].NAME,Ti.App.fireEvent("update_appearance",{item:"shield",gender:e.gender,image:r.shield[s.shield].IMAGE}))});var g=Titanium.UI.createButton({backgroundImage:"/assets/button_small_UP.png",title:e.btn_labels.helmet,height:"10%",width:"100%",top:"52.5%",left:0,font:{fontSize:14},color:"#761f56"});g.addEventListener("click",function(){a&&(s.helmet>=r.helmet.length-1?s.helmet=0:s.helmet++,g.title=r.helmet[s.helmet].NAME,Ti.App.fireEvent("update_appearance",{item:"helmet",gender:e.gender,image:r.helmet[s.helmet].IMAGE}))}),o.add(p),o.add(g)}var h=Titanium.UI.createImageView({top:"75%",image:"/assets/iconDiceRandom.png",height:"18%",left:"5%",width:"40%"});h.addEventListener("click",function(){i()}),o.add(h);var m=Titanium.UI.createButton({backgroundImage:"/assets/button_small_UP.png",title:"Save",height:"10%",top:"64%",width:"100%",left:0,font:{fontSize:14},color:"#761f56"}),f=require("/ui/common/Functions/function");return f.requestServer({success:function(){items_json=JSON.parse(this.responseText),void 0!=items_json.Record&&(r=items_json.Record,s.dress=t(items_json.Record.dress,e.wear_ids.dress),s.face=t(items_json.Record.face,e.wear_ids.head),s.hair=t(items_json.Record.hair,e.wear_ids.hair),"f"==e.gender?s.jewelery=t(items_json.Record.jwelery,e.wear_ids.jewelery):(s.weapon=t(items_json.Record.weapons,e.wear_ids.weapon),s.shield=t(items_json.Record.shield,e.wear_ids.shield),s.helmet=t(items_json.Record.helmet,e.wear_ids.helmet)),a=!0)},method:"GET",contentType:"text/xml",url:"http://bonozo.com:8080/knp/get_avatar_appearance_info.php?gender="+e.gender}),d.addEventListener("click",function(){a&&(s.hair>=r.hair.length-1?s.hair=0:s.hair++,d.title=r.hair[s.hair].NAME,Ti.App.fireEvent("update_appearance",{item:"hair",gender:e.gender,image:r.hair[s.hair].IMAGE}))}),c.addEventListener("click",function(){a&&(s.face>=r.face.length-1?s.face=0:s.face++,c.title=r.face[s.face].NAME,Ti.App.fireEvent("update_appearance",{item:"face",gender:e.gender,image:r.face[s.face].IMAGE}))}),l.addEventListener("click",function(){a&&(s.dress>=r.dress.length-1?s.dress=0:s.dress++,l.title=r.dress[s.dress].NAME,Ti.App.fireEvent("update_appearance",{item:"dress",gender:e.gender,image:r.dress[s.dress].IMAGE}))}),u.addEventListener("click",function(){a&&("f"==e.gender?(s.jewelery>=r.jwelery.length-1?s.jewelery=0:s.jewelery++,u.title=r.jwelery[s.jewelery].NAME):(s.weapon>=r.weapons.length-1?s.weapon=0:s.weapon++,u.title=r.weapons[s.weapon].NAME),Ti.App.fireEvent("update_appearance",{item:"m"==e.gender?"weapon":"jewelery",gender:e.gender,image:"m"==e.gender?r.weapons[s.weapon].IMAGE:r.jwelery[s.jewelery].IMAGE}))}),m.addEventListener("click",function(){var t={};if(t.hair=r.hair[s.hair].WEAR_ID,t.face=r.face[s.face].WEAR_ID,t.dress=r.dress[s.dress].WEAR_ID,"f"==e.gender?t.jewelery=r.jwelery[s.jewelery].WEAR_ID:(t.weapon=r.weapons[s.weapon].WEAR_ID,t.helmet=r.helmet[s.helmet].WEAR_ID,t.shield=r.shield[s.shield].WEAR_ID),"f"==e.gender)var i="http://bonozo.com:8080/knp/set_avatar_appearance.php?uid="+e.uid+"&gender="+e.gender+"&hair_id="+t.hair+"&face_id="+t.face+"&jewelery_id="+t.jewelery+"&dress_id="+t.dress+"&weapon_id=0&helmet_id=0&shield_id=0";else var i="http://bonozo.com:8080/knp/set_avatar_appearance.php?uid="+e.uid+"&gender="+e.gender+"&hair_id="+t.hair+"&face_id="+t.face+"&jewelery_id=0&dress_id="+t.dress+"&weapon_id="+t.weapon+"&helmet_id="+t.helmet+"&shield_id="+t.shield;var n=require("/ui/common/Functions/function");n.requestServer({success:function(){items_json=JSON.parse(this.responseText),void 0!=items_json.Record&&(Ti.App.fireEvent("new_info",{clicked_item:"SceneryCustomization",userinfojson:items_json}),Ti.API.info("URL : "+i),alert("Successfully Updated!"))},method:"GET",contentType:"text/xml",url:i}),Ti.App.fireEvent("save_appearance",t)}),o.add(u),o.add(m),o.add(l),o.add(d),o.add(c),o}module.exports=AvatarCustomization;